name: "Subset Match Test"
description: "Validates subset matching allows extra rows"

periods:
  - identifier: "2026-01"
    level: "month"
    start_date: "2026-01-01"
    end_date: "2026-01-31"

input:
  dataset:
    id: "550e8400-e29b-41d4-a716-446655440002"
    name: "test_products"
    description: "Test products dataset"
    owner: "test"
    version: 1
    status: active
    main_table:
      name: "products"
      temporal_mode: period
      columns:
        - name: "product_id"
          type: integer
          nullable: false
        - name: "price"
          type: decimal
  
  data:
    products:
      rows:
        - product_id: 1
          price: 10.0
          _period: "2026-01"
        - product_id: 2
          price: 20.0
          _period: "2026-01"
        - product_id: 3
          price: 30.0
          _period: "2026-01"

project:
  id: "660e8400-e29b-41d4-a716-446655440002"
  name: "passthrough"
  owner: "test"
  version: 1
  status: active
  visibility: private
  input_dataset_id: "550e8400-e29b-41d4-a716-446655440002"
  input_dataset_version: 1
  materialization: eager
  operations:
    - order: 1
      type: output
      parameters: {}

expected_output:
  data:
    rows:
      - product_id: 1
        price: 10.0
      - product_id: 2
        price: 20.0
      # product_id: 3 is extra, but allowed in subset mode

config:
  match_mode: subset
  validate_metadata: false
  validate_traceability: false
  snapshot_on_failure: false
