<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- vscode Session b2c6d8ec-b34f-4a4e-a655-3c0b15979563 (2026-02-22 23:08Z) -->

# File-based metadata injection issue with _row_id (2026-02-22 23:08Z)

_**User (2026-02-22 23:08Z)**_

### [CRITICAL] File-based metadata injection violates `_row_id` contract
**File:** `crates/cli/src/harness/executor.rs`  
**Line:** `309-333`  
**Issue:** `inject_file_metadata_lazy()` sets `_row_id` to one static string (`"{table}_{timestamp}"`) for all rows and not a UUID v7, which violates FR-004 and can create duplicate row IDs.  
**Suggested fix:** Generate a per-row UUID v7 value (and consistent timestamp format) when enriching file-backed data, e.g. materialize once, add `_row_id` series from `Uuid::now_v7()` per row, then convert back to `LazyFrame`.


---

_**Agent (model copilot/gpt-5.3-codex)**_

<tool-use data-tool-type="read" data-tool-name="copilot_readFile">
<details>
<summary>Tool use: **copilot_readFile** • Reading [](file:///home/marcos/Projects/.worktrees/dobonomodo-S02/crates/cli/src/harness/executor.rs#250-250), lines 250 to 380</summary>


Read [](file:///home/marcos/Projects/.worktrees/dobonomodo-S02/crates/cli/src/harness/executor.rs#250-250), lines 250 to 380

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="copilot_findTextInFiles">
<details>
<summary>Tool use: **copilot_findTextInFiles** • Searching for regex `inject_file_metadata_lazy|_row_id|now_v7|_created_at|_updated_at` (`**/crates/cli/src/harness/executor.rs`)</summary>


Searched for regex `inject_file_metadata_lazy|_row_id|now_v7|_created_at|_updated_at` (`**/crates/cli/src/harness/executor.rs`), 10 results

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="copilot_readFile">
<details>
<summary>Tool use: **copilot_readFile** • Reading [](file:///home/marcos/Projects/.worktrees/dobonomodo-S02/crates/cli/src/harness/executor.rs#1-1), lines 1 to 120</summary>


Read [](file:///home/marcos/Projects/.worktrees/dobonomodo-S02/crates/cli/src/harness/executor.rs#1-1), lines 1 to 120

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="copilot_readFile">
<details>
<summary>Tool use: **copilot_readFile** • Reading [](file:///home/marcos/Projects/.worktrees/dobonomodo-S02/crates/cli/src/harness/executor.rs#680-680), lines 680 to 800</summary>


Read [](file:///home/marcos/Projects/.worktrees/dobonomodo-S02/crates/cli/src/harness/executor.rs#680-680), lines 680 to 800

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="copilot_findTextInFiles">
<details>
<summary>Tool use: **copilot_findTextInFiles** • Searching for regex `Uuid|uuid::` (`**/crates/cli/src/harness/executor.rs`)</summary>


Searched for regex `Uuid|uuid::` (`**/crates/cli/src/harness/executor.rs`), 7 results

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="copilot_findTextInFiles">
<details>
<summary>Tool use: **copilot_findTextInFiles** • Searching for regex `_created_at|_updated_at|inject_system_metadata_for_mode|row_id|now_v7|RFC3339|to_rfc3339` (`**/crates/**`)</summary>


Searched for regex `_created_at|_updated_at|inject_system_metadata_for_mode|row_id|now_v7|RFC3339|to_rfc3339` (`**/crates/**`), 20 results

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="copilot_readFile">
<details>
<summary>Tool use: **copilot_readFile** • Reading [](file:///home/marcos/Projects/.worktrees/dobonomodo-S02/crates/test-resolver/src/lib.rs)</summary>


Read [](file:///home/marcos/Projects/.worktrees/dobonomodo-S02/crates/test-resolver/src/lib.rs)

</details>
</tool-use>

---

I’ll patch the metadata injection in `executor.rs` to generate a unique UUID v7 per row and keep timestamp formatting consistent, then run targeted checks to verify it compiles. I’m starting by reading the relevant section and nearby helpers.**Inspecting imports and test assertions**I found the exact function; next I’ll check imports and existing tests in this file so I can apply a minimal fix and add/adjust coverage for unique `_row_id` behavior.**Assessing UUID imports and tests****Assessing UUID usage and timestamp formatting**I confirmed `Uuid` is only imported in tests right now, so I’m checking existing metadata injection conventions to match timestamp format before patching.**Reviewing injection

---

